"0","if (weapon$Bulk !='L') {"
"0","  currentBulk <- as.integer(weapon$Bulk)"
"0","  lightCount <- 0"
"0","} else {"
"0","  currentBulk <- 0"
"0","  lightCount <- 1"
"0","}"
"0","maxBulk <- Bonus$Strength + 5"
"0",""
"0","goldRemaining <- 5"
"0",""
"0","equipment <- sample_n(adventuringGear, 1)"
"0","i <- 0"
"0","itemCount <- 1"
"0","maxItems <- runif(1, min=8, max=15)"
"0","repeat {"
"0","  i=i+1"
"0","  if (i > 100 | itemCount >= maxItems) {"
"0","    break"
"0","  }"
"0","  "
"0","  nequip <- sample_n(adventuringGear, 1)"
"0","  floatBulk <- nequip$Bulk[1]"
"0","  "
"0","  #gold conversion"
"0","  gp <- gp_conversion(nequip$Price)"
"0","  "
"0","  #Light handling"
"0","  if (nequip$Bulk[1] == 'L') {"
"0","    lightCount <- lightCount + 1"
"0","    "
"0","    if (lightCount == 10) {"
"0","      floatBulk <- 1"
"0","    } else {"
"0","      floatBulk <- 0"
"0","    }"
"0","  }"
"0","  "
"0","  # True up"
"0","  if (goldRemaining - gp > 0 && as.integer(currentBulk) + as.integer(floatBulk) <= maxBulk) {"
"0","    goldRemaining <- goldRemaining - gp"
"0","    currentBulk <- as.integer(currentBulk) + as.integer(floatBulk)"
"0","    equipment <- add_row(equipment, nequip)"
"0","    itemCount <- itemCount + 1"
"0","  }"
"0","}"
"0",""
"0","equipment$Count <- 1"
"0",""
"0","equipment <- select(equipment, -c(Available, Spoilers)) %>% group_by(Name) %>% ddply(.,colnames(.),summarize,Count=sum(Count)) %>% arrange(desc(Name))"
"0",""
"0","equipment <- equipment[, c(1,ncol(equipment) ,3:(ncol(equipment)-1) )]"
"0",""
"0","goldRemaining <- floor(goldRemaining)"
